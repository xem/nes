<!doctype html>
<title>NES emulator</title>

<style>
* { font: 10px arial }
table { border-collapse: collapse }
</style>

<h4>ROM</h4>
<input type=file id=browse>
<p id=rom_info>
<script src=gamepak.js></script>
<script>

// Globals
gamepak = {}
CPU = {}
PPU = {}
OAM = {}
IO = {}

// Manual demo: load a ROM and parse it
browse.onchange = function(e){
  var filename = browse.files[0].name;
  var file = new FileReader;
  file.readAsArrayBuffer(browse.files[0]),
  file.onload = function(){
    parse_rom(file, filename);
    console.log(gamepak);
  }
}

// Auto demo: load "SMB (U).nes" and parse it
onload = function(){
  filename = "SMB (U).nes";
  file = new XMLHttpRequest;
  file.open('GET', filename);
  file.responseType = 'arraybuffer';
  file.send();
  file.onload = function(){
    file.result = file.response;
    parse_rom(file, filename);
    console.log(gamepak);
  }
}

</script>